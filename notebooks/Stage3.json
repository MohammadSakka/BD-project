{"paragraphs":[{"text":"\nimport pyspark.sql.functions as F\nfrom pyspark.sql import SparkSession\nfrom pyspark.ml import Pipeline\n\n\nspark = SparkSession.builder\\\n    .appName(\"BDT FlightsDelay\")\\\n    .master(\"local[*]\")\\\n    .config(\"hive.metastore.uris\", \"thrift://sandbox-hdp.hortonworks.com:9083\")\\\n    .config(\"spark.sql.catalogImplementation\",\"hive\")\\\n    .config(\"spark.sql.avro.compression.codec\", \"snappy\")\\\n    .config(\"spark.jars\", \"file:///usr/hdp/current/hive-client/lib/hive-metastore-1.2.1000.2.6.5.0-292.jar,file:///usr/hdp/current/hive-client/lib/hive-exec-1.2.1000.2.6.5.0-292.jar\")\\\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-avro_2.12:3.0.3\")\\\n    .enableHiveSupport()\\\n    .getOrCreate()\n\n\nsc = spark.sparkContext\n\nprint(sc)","user":"anonymous","dateUpdated":"2023-09-22T18:03:38+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{"0":{"graph":{"mode":"table","height":93.125,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865078_1071595766","id":"20230418-170215_770335024","dateCreated":"2023-09-22T16:41:05+0000","dateStarted":"2023-09-22T17:24:51+0000","dateFinished":"2023-09-22T17:25:22+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:41518"},{"text":"print(spark.catalog.listDatabases())","dateUpdated":"2023-09-22T16:41:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865910_2130424739","id":"20230418-170331_411480095","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41519"},{"text":"print(spark.catalog.listTables(\"FlightsDelay\"))","dateUpdated":"2023-09-22T17:29:20+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865916_2126577250","id":"20230418-170514_65557247","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41520"},{"text":"Airport = spark.read.format(\"avro\").table('FlightsDelay.Airport')\nAirport.createOrReplaceTempView('Airport')\n\nPlane = spark.read.format(\"avro\").table('FlightsDelay.Plane')\nPlane.createOrReplaceTempView('Plane')\n\nCarrier = spark.read.format(\"avro\").table('FlightsDelay.Carrier')\nCarrier.createOrReplaceTempView('Carrier')\n\nTrip = spark.read.format(\"avro\").table('FlightsDelay.Trip')\nTrip.createOrReplaceTempView('Trip')\n","dateUpdated":"2023-09-22T17:48:53+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400865923_-2085284284","id":"20230418-170537_841852183","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41521"},{"text":"Airport.printSchema()\n","dateUpdated":"2023-09-22T17:49:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865932_-2088362275","id":"20230418-170639_396518427","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41522"},{"text":"Plane.printSchema()","dateUpdated":"2023-09-22T17:49:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865941_-2079513050","id":"20230418-171030_1112422881","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41523"},{"text":"Carrier.printSchema()","dateUpdated":"2023-09-22T17:49:17+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865950_-2081436795","id":"20230418-171052_1505565650","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41524"},{"text":"Trip.printSchema()","dateUpdated":"2023-09-22T17:49:29+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865961_-2099519993","id":"20230418-171100_2017900825","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41525"},{"text":"spark.sql(\"SELECT COUNT(t1.id) FROM (SELECT id FROM Trip GROUP BY id HAVING COUNT(*) = 1) t1\").show()","dateUpdated":"2023-09-22T17:52:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865967_-2100289491","id":"20230418-171109_572374856","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41526"},{"text":"Trip.head()","dateUpdated":"2023-09-22T17:53:11+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865973_-2091825015","id":"20230418-171310_701910244","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41527"},{"text":"import sys\nreload(sys)\nsys.setdefaultencoding('utf-8')","dateUpdated":"2023-09-22T16:41:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865979_-2092594513","id":"20230418-173153_252582942","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41528"},{"text":"(Trip[Trip.abv.isNull()].count()),Trip.count()","dateUpdated":"2023-09-22T17:53:34+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865987_-2107984469","id":"20230418-173621_686036224","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41529"},{"text":"Trip = Trip.na.drop()","dateUpdated":"2023-09-22T17:53:41+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400865992_-2111447209","id":"20230418-173909_1846605685","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41530"},{"text":"from pyspark.sql.functions import col\nfrom pyspark.sql.types import DecimalType\n\nTrip = Trip.withColumn('name', F.translate(\"name\",\"'\",\"\"))\\\n    .withColumn('style', F.translate(\"style\",\"'\",\"\"))\\\n    .withColumn('abv', col('abv').cast(DecimalType()))\nTrip.show()","dateUpdated":"2023-09-22T17:54:04+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400865997_-2113370953","id":"20230418-173014_145955720","dateCreated":"2023-09-22T16:41:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41531"},{"text":"Trip.head()","dateUpdated":"2023-09-22T17:54:12+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866003_-2101828486","id":"20230418-174407_1059532675","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41532"},{"text":"Trip = Trip.withColumn('year', F.translate(\"year\",\"'\",\"\"))\nTrip.show()","dateUpdated":"2023-09-22T17:55:45+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866026_-2122989676","id":"20230418-174512_1604688715","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41533"},{"text":"(Trip[Trip.year.isNull()].count()),brewer.count()","dateUpdated":"2023-09-22T17:56:04+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866042_-2116833693","id":"20230418-174607_558336862","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41534"},{"text":"Airport.head()","dateUpdated":"2023-09-22T17:56:17+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866057_-2037960169","id":"20230418-174623_1728156238","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41535"},{"text":"Airport = Airport.withColumn('IATA_code', F.translate(\"IATA_code\",\"'\",\"\"))\nAirport.show()","dateUpdated":"2023-09-22T17:56:40+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866075_-2031034689","id":"20230418-174710_1066874492","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41536"},{"text":"(Airport[Airport.IATA_code.isNull()].count()),Airport.count()","dateUpdated":"2023-09-22T17:57:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866086_-2047578891","id":"20230418-174806_1846457271","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41537"},{"text":"Carrier.head()","dateUpdated":"2023-09-22T17:57:14+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866115_-2058736610","id":"20230418-174923_1653618521","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41538"},{"text":"### Linear Regression","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866144_-2071433323","id":"20230514-192552_650726795","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41539"},{"text":"SELECT *\nt1 = FROM Airport\nINNER JOIN Trip\nON  Trip.airportId = Airport.IATA_code\nt2 = SELECT *\nFROM Carrier\nINNER JOIN t2\nON  t2.Carrier_id = Carrier.carrier_code\nt3 = SELECT *\nFROM Plane\nINNER JOIN t3\nON  t3.plane_id = Plane.tail_number\nagg_dataset = t3\ntrain_df, test_df = agg_dataset.randomSplit([0.8, 0.2])\n","dateUpdated":"2023-09-22T18:11:33+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400866149_-2073357068","id":"20230514-192559_1241346593","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41540"},{"text":"from pyspark.sql import Row\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.feature import VectorAssembler\nfrom pyspark.ml.feature import StringIndexer\n\ntext_features = ['style']\n\nindexer = [\n    StringIndexer(inputCol = feature, outputCol=feature + '_indexed')\n    for feature in text_features\n]\n\nassembler = VectorAssembler(\n    inputCols=['rid', 'abv', 'style_indexed', 'id'],\n    outputCol='features')\n\npipeline = Pipeline(stages=indexer+[assembler])\n    \n\nmodel = pipeline.fit(train_df)\ntrain_transformed = model.transform(train_df)\ntest_transformed = model.transform(test_df)","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866159_-2075665561","id":"20230514-192733_1504464527","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41541"},{"text":"train_transformed.head()","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866166_-2066046839","id":"20230514-192635_459410375","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41542"},{"text":"from pyspark.ml.regression import LinearRegression\n\nlr = LinearRegression(maxIter=10, regParam=0.01, elasticNetParam=0.8, featuresCol='features', labelCol='total')\nlrModel = lr.fit(train_transformed)\ntrain_pred = lrModel.transform(train_transformed)\ntest_pred = lrModel.transform(test_transformed)\n","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866176_-1985249570","id":"20230514-192637_1909707438","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41543"},{"text":"\n# Print the coefficients and intercept for linear regression\nprint(\"Coefficients: %s\" % str(lrModel.coefficients))\nprint(\"Intercept: %s\" % str(lrModel.intercept))\n\n# Summarize the model over the training set and print out some metrics\ntrainingSummary = lrModel.summary\nprint(\"numIterations: %d\" % trainingSummary.totalIterations)\nprint(\"objectiveHistory: %s\" % str(trainingSummary.objectiveHistory))\ntrainingSummary.residuals.show()\nprint(\"RMSE: %f\" % trainingSummary.rootMeanSquaredError)\nprint(\"r2: %f\" % trainingSummary.r2)","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866180_-1986788565","id":"20230514-192650_2093954933","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41544"},{"text":"unlabeled_data=test_transformed.select('features')\npredictions=lrModel.transform(unlabeled_data)\npredictions.show()","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866184_-1988327561","id":"20230514-192617_411794843","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41545"},{"text":"from pyspark.ml.evaluation import RegressionEvaluator\nfrom pyspark.ml.regression import LinearRegression\nfrom pyspark.ml.tuning import ParamGridBuilder, TrainValidationSplit, CrossValidator\n\n\nlr = LinearRegression(maxIter=10, featuresCol='features', labelCol='total')\n\nparamGrid = ParamGridBuilder()\\\n    .addGrid(lr.regParam, [0.1, 0.01]) \\\n    .addGrid(lr.fitIntercept, [False, True])\\\n    .addGrid(lr.elasticNetParam, [0.0, 0.5, 1.0])\\\n    .build()\n    \nevaluator = RegressionEvaluator(metricName=\"mse\", predictionCol='prediction', labelCol='total')\n\nlr_cv = CrossValidator(estimator=lr, estimatorParamMaps=paramGrid, \\\n                        evaluator=evaluator, numFolds=3)\nlrModel = lr_cv.fit(train_transformed)\nmodel = lrModel.bestModel","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866195_-1978708838","id":"20230514-192801_1068131075","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41546"},{"text":"print('Best Param (regParam): ', model._java_obj.getRegParam())","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866203_-1981786830","id":"20230514-192810_106957358","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41547"},{"text":"print('Best Param (MaxIter): ', model._java_obj.getMaxIter())","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866216_-2000639526","id":"20230514-192818_1538916089","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41548"},{"text":"print('Best Param (elasticNetParam): ', model._java_obj.getElasticNetParam())","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866220_-2002178521","id":"20230514-192827_2111699176","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41549"},{"text":"\nmodel.transform(test_transformed)\\\n    .select(\"features\", \"total\", \"prediction\")\\\n    .show()","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866230_-1992175050","id":"20230514-192837_358692589","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41550"},{"text":"# Summarize the model over the training set and print out some metrics\ntrainingSummary = model.summary\nprint(\"numIterations: %d\" % trainingSummary.totalIterations)\nprint(\"objectiveHistory: %s\" % str(trainingSummary.objectiveHistory))\ntrainingSummary.residuals.show()\nprint(\"RMSE: %f\" % trainingSummary.rootMeanSquaredError)\nprint(\"r2: %f\" % trainingSummary.r2)","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866254_-2013720988","id":"20230514-192847_1808261005","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41551"},{"text":"### ALS model","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866264_-2006795508","id":"20230514-192546_1667732673","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41552"},{"text":"train_df, test_df = review.randomSplit([0.8, 0.2])","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866271_-2007949755","id":"20230514-193004_222532355","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41553"},{"text":"from pyspark.ml.recommendation import ALS\nmaxIter=10\nrank=4\nregParam=0.01\nals = ALS(maxIter=maxIter, rank=rank, regParam=regParam, itemCol='beerid', userCol='reviewerid', ratingCol='total')","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400866283_-2024878706","id":"20230418-182445_1897507088","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41554"},{"text":"model = als.fit(train_df)","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866295_-2017183728","id":"20230418-183802_559810810","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41555"},{"text":"import pyspark\npyspark.__version__","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866303_-2020261720","id":"20230514-125821_1289950829","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41556"},{"text":"recommendations = model.recommendForAllUsers(5)\nrecommendations.head(5)","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866310_1964213214","id":"20230418-184221_781043780","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41557"},{"text":"item_recs = model.recommendForAllItems(3)\nitem_recs.head(5)","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866331_1968445452","id":"20230418-185325_1812027535","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41558"},{"text":"predictions = model.transform(test_df).withColumn('prediction', col('prediction').cast(DecimalType()))","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400866351_1948438509","id":"20230418-190130_1459555205","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41559"},{"text":"predictions","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866362_1956518236","id":"20230418-190903_1555172410","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41560"},{"text":"from pyspark import keyword_only\nfrom pyspark.ml.evaluation import Evaluator\nfrom pyspark.ml.param.shared import Param\nfrom pyspark.mllib.evaluation import RankingMetrics\nfrom pyspark.sql import Window\nfrom pyspark.sql.functions import col\nfrom pyspark.sql.functions import expr\nimport pyspark.sql.functions as F\n\nclass RankingEvaluator(Evaluator):\n    def __init__(self, k=None):\n        super(RankingEvaluator, self).__init__()\n        self.k = Param(self, 'k', 'Top K')\n        self._setDefault(k=30)\n        \n    def isLargerBetter(self):\n        return True\n        \n    def setK(self, value):\n        self._paramMap[self.k] = value\n        return self\n        \n    def getK(self):\n        return self.getOrDefault(self.k)\n        \n    def _evaluate(self, predictedDF):\n        k = self.getK()\n        \n        windowSpec = Window.partitionBy('beerid').orderBy(col('prediction').desc())\n        perCommunityPredictedUsersDF = predictedDF \\\n            .select('reviewerid', 'beerid', 'prediction', F.rank().over(windowSpec).alias('rank')) \\\n            .where('rank <= {0}'.format(k)) \\\n            .groupBy('beerid') \\\n            .agg(expr('collect_list(reviewerid) as items'))\n            \n        windowSpec = Window.partitionBy('beerid').orderBy(col('total').desc())\n        perCommunityActualUsersDF = predictedDF \\\n            .select('reviewerid', 'beerid', 'total', F.rank().over(windowSpec).alias('rank')) \\\n            .where('rank <= {0}'.format(k)) \\\n            .groupBy('beerid') \\\n            .agg(expr('collect_list(reviewerid) as items'))\n            \n        perCommunityRdd = perCommunityPredictedUsersDF.join(F.broadcast(perCommunityActualUsersDF), 'beerid', 'inner') \\\n            .rdd \\\n            .map(lambda row: (row[1], row[2]))\n            \n        if perCommunityRdd.isEmpty():\n            return 0.0\n            \n        rankingMetrics = RankingMetrics(perCommunityRdd)\n        return rankingMetrics.ndcgAt(k)\n","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866425_1930740060","id":"20230418-190512_594996681","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41561"},{"text":"evaluator = RankingEvaluator(k = 20)\nresults = evaluator.evaluate(predictions)","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866504_1986528650","id":"20230418-190418_2068858700","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41562"},{"text":"print(\"NDCG \"+str(results))\n","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866527_1991530386","id":"20230418-193429_2065634635","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41563"},{"text":"from pyspark.ml.tuning import ParamGridBuilder, CrossValidator\n\ngrid = ParamGridBuilder()\ngrid = grid\\\n.addGrid(als.regParam, [0.0004, 0.007, 0.010])\\\n.addGrid(als.rank, [4, 7])\\\n.addGrid(als.maxIter, [5, 10]).build()\n\ncv = CrossValidator(estimator = als, \n                    estimatorParamMaps = grid, \n                    evaluator = evaluator,\n                    parallelism = 5,\n                    numFolds=3)\n\ncvModel = cv.fit(train_df)\n\n","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866536_1974216685","id":"20230418-195143_885616753","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41564"},{"text":"predictions = cvModel.transform(test_df).withColumn('prediction', col('prediction').cast(DecimalType()))","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866638_2035007012","id":"20230418-202622_1588426083","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41565"},{"text":"evaluator = RankingEvaluator(k = 20)\nresults = evaluator.evaluate(predictions)","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866642_2045779981","id":"20230418-203928_1435381027","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41566"},{"text":"print(\"NDCG \"+str(results))","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866645_2043086739","id":"20230418-204015_1533988238","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41567"},{"text":"def predictDelay(trips, numitems, model):\n    df = spark.createDataFrame(data=trips, schema = [\"tripId\"])\n    return model.recommendForUserSubset(df, numitems)['tripId']","dateUpdated":"2023-09-22T18:18:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400866652_2040393496","id":"20230504-115543_1073193425","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41568"},{"text":"","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866661_2024618791","id":"20230514-130717_1160857913","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41569"},{"text":"predictDelay([[77247]],5,model)","dateUpdated":"2023-09-22T18:19:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866668_2021925549","id":"20230514-125940_1980937295","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41570"},{"text":"#### KNN based algorithm","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400866680_2029620527","id":"20230418-204131_991656454","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41571"},{"text":"from pyspark.ml.feature import Word2Vec, IDF,Tokenizer,StopWordsRemover, StandardScaler\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.feature import OneHotEncoder, StringIndexer, VectorAssembler\n\ntext_features = ['brewery_name','name','style']\ntokenizers = [\n    Tokenizer(inputCol = feature, outputCol=feature + 'token')\n    for feature in text_features\n]\nswremovals = [\n    StopWordsRemover(inputCol=feature + 'token', outputCol=feature + 'sw')\n    for feature in text_features\n]\ntext_encoders = [\n    Word2Vec(vectorSize=20, minCount=0, inputCol = feature + 'sw', outputCol=feature + 'enc')\n    for feature in text_features\n]\n\n\nfinal_assembler = VectorAssembler(\n    inputCols = [feature + 'enc' for feature in text_features]+['abv'],\n    outputCol = 'processed_features'\n)\nscaler = StandardScaler(inputCol = \"processed_features\", outputCol = \"scaled_features\")\n\n\npipeline = Pipeline(stages=tokenizers+swremovals+text_encoders+[\n    final_assembler,\n    scaler])","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400866689_2112341541","id":"20230418-205000_1368972881","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41572"},{"text":"model = pipeline.fit(train_df)","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866716_2114265285","id":"20230418-205234_460970204","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41573"},{"text":"train_transformed = model.transform(train_df)\ntest_transformed = model.transform(test_df)","dateUpdated":"2023-09-22T16:41:06+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/32/temp_shuffle_d69172f1-713c-4aac-aa21-5a836c7c9b35, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/15/temp_shuffle_87bafe47-f889-42cc-9eb1-33193492f691, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/37/temp_shuffle_1c436d15-b89e-4777-8b0f-2b5f5c78be45, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/11/temp_shuffle_87729c98-bd57-40fa-95f8-e0a470a2a032, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0b/temp_shuffle_a2bdf899-aa25-4cb2-bf1e-bbde113747f9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/00/temp_shuffle_3f4dfbeb-7b8d-48b0-9ad8-66d243c5032d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/00/temp_shuffle_1885e220-5398-4658-b6de-40fa96b93742, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2c/temp_shuffle_4b9c5f81-a6b5-458a-957b-f37f69d56c09, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/37/temp_shuffle_0dc42e8f-6695-4baf-bbea-f36f4e8ff38f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/00/temp_shuffle_3e30e519-2b10-4615-8347-95183a8e3cef, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/28/temp_shuffle_e3f806cd-8df9-443c-984a-f97266b1ddb0, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/16/temp_shuffle_1ccb2ee9-db2c-4bfd-a96d-41878eb8fbfa, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/10/temp_shuffle_ec085a5c-081b-41ca-85b6-c3a4db8a45be, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/06/temp_shuffle_e6cac823-de06-4e3c-aa2b-b7adbc68bd30, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/38/temp_shuffle_eeb32685-7344-4c58-8128-3ce43fd83616, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/25/temp_shuffle_10bedf1d-f4e3-4602-96fb-c1ea0d1a3ac5, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/05/temp_shuffle_11bc1192-68f1-454b-9aa0-3a5d495eeb55, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/31/temp_shuffle_93eae955-036b-4d58-86f7-67df8c10c447, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2b/temp_shuffle_e17fbef9-c8c5-4a95-818d-13fb29c5d21b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/33/temp_shuffle_31145564-8453-4803-a3bf-9227cf617c48, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/07/temp_shuffle_1fb4944a-02a6-4761-82b7-f67b4f760454, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0d/temp_shuffle_3b8c28ae-6dc9-4e57-ad1c-fe6772bf01bf, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/26/temp_shuffle_c6c8feb0-2c2f-4bfe-8fb9-482728d996b2, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/32/temp_shuffle_aa041566-5e5a-4088-918b-6d20449eabac, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3a/temp_shuffle_eb5f766d-9896-4460-b534-db281182a2d9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/00/temp_shuffle_7bd934b2-5b4c-41b5-a380-bd187f04fb40, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/17/temp_shuffle_18496c72-03d2-4fa8-9380-7d51b6c4c4cb, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/20/temp_shuffle_3d65cced-327e-40f2-8582-7c6889c19bb8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/22/temp_shuffle_71edb1ba-2f65-4425-820a-b13089bbe27b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/07/temp_shuffle_b4f2d8af-029b-4166-b056-3251089985e3, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/24/temp_shuffle_9ccacc03-20a9-412e-b949-b044420a3dea, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/08/temp_shuffle_c54702e4-b036-4247-b126-feeb896d0fd7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/15/temp_shuffle_cac4182e-3fb4-4166-9d87-994b669f05f3, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/14/temp_shuffle_b7033062-1515-4f15-a65e-1664d91aaa70, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1d/temp_shuffle_7a7bb12b-5da8-46ea-bf27-d2ab6bda03e9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3f/temp_shuffle_90843df1-7ff4-45ab-8dbe-2d587551fe30, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/19/temp_shuffle_af4db36b-4d76-4496-8fa3-dc0c435b868d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/09/temp_shuffle_9d8ba3db-6b8b-4c7b-8865-9333cf54d24f, null\n23/04/19 04:12:50 WARN io.Closeables: IOException thrown while closing Closeable.\njava.nio.channels.ClosedChannelException\n\tat sun.nio.ch.FileChannelImpl.ensureOpen(FileChannelImpl.java:110)\n\tat sun.nio.ch.FileChannelImpl.position(FileChannelImpl.java:253)\n\tat org.apache.spark.shuffle.sort.io.LocalDiskShuffleMapOutputWriter$PartitionWriterChannel.getCount(LocalDiskShuffleMapOutputWriter.java:263)\n\tat org.apache.spark.shuffle.sort.io.LocalDiskShuffleMapOutputWriter$PartitionWriterChannel.close(LocalDiskShuffleMapOutputWriter.java:274)\n\tat org.sparkproject.guava.io.Closeables.close(Closeables.java:77)\n\tat org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.writePartitionedDataWithChannel(BypassMergeSortShuffleWriter.java:239)\n\tat org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.writePartitionedData(BypassMergeSortShuffleWriter.java:205)\n\tat org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:167)\n\tat org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:127)\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:463)\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1377)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:466)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3b/temp_shuffle_d10c1783-c327-4897-bf2b-bf2ed05a52d2, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0d/temp_shuffle_6744539d-5c6f-425c-a2fb-0398395a51cd, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2c/temp_shuffle_b5963a80-0ef4-469b-abe2-afccc4cf6352, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0b/temp_shuffle_628682aa-e88b-4e30-9341-940f310d4afb, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/02/temp_shuffle_dead298b-1b75-407d-8ce6-f7459b1e7b22, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_e6e44de6-a0a8-4c0d-a10a-3079f89911e9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/14/temp_shuffle_93af054e-3328-4b75-8273-7fc31bcb52e7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/19/temp_shuffle_023d70f9-a722-4e0e-b690-d1a135389768, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/11/temp_shuffle_fad024b4-bd35-4200-93a0-69e8cd008cd4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/00/temp_shuffle_667f2119-c029-4513-b468-c988984cb749, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2d/temp_shuffle_ba899ecb-9834-4925-8eb5-4044e12e9272, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/31/temp_shuffle_f5625472-8a2d-4f6f-b1ff-7b83d5d59994, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/12/temp_shuffle_d38494b8-c545-4ec4-80b2-dbf7a4a6baae, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3a/temp_shuffle_1aed4281-d8a6-4dd3-8985-285485d6caaf, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/22/temp_shuffle_e3af1293-650d-482a-bd9c-fae1592a57f5, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/20/temp_shuffle_966dbb2a-a88b-4dff-bae0-2f51f518a292, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/36/temp_shuffle_3b5cd446-4a55-4839-8182-c33a3bddd4c2, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0d/temp_shuffle_129f8cb6-3bfc-4280-9d03-e2a5fbd9ce76, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/17/temp_shuffle_4bb0e112-0619-47a3-aaee-f0172ee63c59, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3a/temp_shuffle_e8437e08-a3da-4488-a8d1-d91f05a94030, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2e/temp_shuffle_8ee1612a-a64f-4e10-8bb5-8d2aac958b3b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2a/temp_shuffle_95fafd7a-3521-4dfe-8358-85eda2c1323c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/21/temp_shuffle_348bc548-25f2-4dd9-b505-729af20ac464, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/23/temp_shuffle_ecbeae34-3ff1-4012-896e-b85450d6e945, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0c/temp_shuffle_ba1a60ed-df08-49ff-818c-d1fd24619566, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/07/temp_shuffle_eab551cf-513e-4302-8e52-a5326bd75bee, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/23/temp_shuffle_6585b330-354d-4254-91ce-4b502ae024a3, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/28/temp_shuffle_16afdce2-a635-4efb-b4ff-8e147ba0058f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/35/temp_shuffle_62deea9e-6ec4-4181-99bf-b4f1454c23ba, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_33ff6713-bb39-4f27-90ae-0c5df0ccbe8a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/15/temp_shuffle_3c8796e3-4ef3-4864-b39e-7fb222e7a50d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/27/temp_shuffle_428fd426-be89-4b1f-8898-b24952891ab5, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/26/temp_shuffle_d64a6608-4344-4fe8-8fb1-903d46581838, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1d/temp_shuffle_2a529b46-8cfe-4add-b2bf-dbf8cc015e7b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/39/temp_shuffle_7d046604-edf4-4d5b-a927-22276997293f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1b/temp_shuffle_621d9902-cb5b-4373-8ba1-a10ac0c5e476, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_5cad2330-4e45-46a1-8ed5-ad1483354fa7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_483d8f6f-ad4b-46a2-a70f-36982c8290f5, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/17/temp_shuffle_2be5a567-ce15-4a92-baf3-cd5f8a6b6e92, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_e260f54b-5e7e-432d-8820-9f30269976ea, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/34/temp_shuffle_064cee35-c5d5-41b5-9006-51d4ff249e02, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/25/temp_shuffle_bd98b5fb-4b97-4233-8972-9a3139b69f23, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/15/temp_shuffle_cd6c4702-e16f-42d7-bbcc-096812574756, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/24/temp_shuffle_b8adca15-58df-4b61-8264-03579a685a0a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1f/temp_shuffle_b93e0616-04a8-4654-8a4c-1279d769187c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/07/temp_shuffle_1b9c85e4-48b2-496d-9ea4-ae2fd0ec20cd, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0e/temp_shuffle_67099cea-e94b-4d4f-a32d-b841b151b698, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_79ffc980-6d50-4172-9246-396a5caf3cf9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/28/temp_shuffle_94d1f45e-4ad4-4481-9d79-8ecbce5a0c49, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/25/temp_shuffle_2edd11f3-6ad5-45db-9cc5-0bc497216b45, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1c/temp_shuffle_f9b6a2c9-9bfe-40a1-ab24-b041cb6e0847, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1a/temp_shuffle_faa976f4-1615-4fc8-a9a1-b2a8271003e6, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0d/temp_shuffle_67ef351d-1b02-4262-bd5b-cabea39b8f69, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0c/temp_shuffle_afc22440-d552-4460-8fdf-79224bd86c84, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/34/temp_shuffle_c958ed44-29a3-43d5-b608-534bcdc9ead5, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3d/temp_shuffle_05ea3d6b-b2de-4605-84c2-96fe4f49cb90, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/26/temp_shuffle_a4e8ee0f-3b82-4cd6-bee2-9ae0eac1f9ab, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/17/temp_shuffle_4b1a69a2-43d6-4202-b96d-7178f4d62894, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/03/temp_shuffle_7a4ccb27-a027-4130-ace2-a8a3416721a9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/08/temp_shuffle_0bc33f89-0495-47f7-a42a-e5aefc8a9a74, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/03/temp_shuffle_5fcdb0e5-ede8-4424-a276-d7c3bea8b71a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/33/temp_shuffle_66c349ad-1777-4152-831b-5078ef04dafd, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/19/temp_shuffle_0095d5eb-5578-4f52-b2bd-7f6d54b5cd77, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0a/temp_shuffle_2c05e068-1855-4c5d-a701-e4146415fd1a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/03/temp_shuffle_613b5c52-d3c8-451c-b380-46262cbf52ba, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/12/temp_shuffle_75aa963a-73ad-4654-8c7b-c672bf888273, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/01/temp_shuffle_cb389b5c-2046-4b94-89f1-803a4e8e61a8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3f/temp_shuffle_622b3efd-db7c-4f43-9c0b-5c6ec8a1ae89, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_ce15fb70-c9cf-4e8d-95c1-cd07b0c86541, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/15/temp_shuffle_410b1058-6559-411d-9bef-96c3217cf0f4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0e/temp_shuffle_68b1bdc9-c16a-4a19-8c3b-ea7f8b5f824f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0d/temp_shuffle_0bf77645-bf9a-4686-b494-bbf85bc62668, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1c/temp_shuffle_a4986eec-559f-4379-ba59-feb27dcd52de, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3e/temp_shuffle_2d3247af-84e4-419a-bfa1-3cbbf2de584b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/25/temp_shuffle_9eb23eb8-a20f-4b1a-b5be-ea40c77cf025, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/20/temp_shuffle_7a109d5f-6265-4cb1-8deb-b041912928cc, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2e/temp_shuffle_e7b22e9a-0de2-4c1a-b2a6-26b2e9b8974c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/31/temp_shuffle_917df7c7-ee61-4fbe-ae65-9c69f7d0d229, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/09/temp_shuffle_9599bc27-fd00-402b-8a25-74e5332db6e4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/26/temp_shuffle_0528d1e4-47b6-4f2b-9eb3-73eb3fd2a53e, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/27/temp_shuffle_a5996300-b39c-4dc5-978c-2df5b6ee50a8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0d/temp_shuffle_95750266-0779-4424-8784-66f96b4f2edb, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1d/temp_shuffle_0f075a00-1613-4f3b-b8ba-b59fe55742e3, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/35/temp_shuffle_e1ec18f1-69fa-4215-86b8-e32239d21fef, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3c/temp_shuffle_2309a908-eef9-4df0-8474-c4b7bb9c7527, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_4b981ae3-f0d9-4501-b11d-9a6efd8da5b2, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3e/temp_shuffle_83b73c7d-a533-48d0-a432-c5b21ea9b240, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/06/temp_shuffle_720e6f67-baf1-4e03-b8dd-824a51123caa, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/39/temp_shuffle_d15621df-1e49-4bf2-b614-880188b7ceb9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/32/temp_shuffle_f82c510b-3f19-4b69-a755-a1fcfc9d2f47, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/07/temp_shuffle_695aab8b-9c19-4b66-8c66-f9b2fb5d8ef6, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/18/temp_shuffle_df87a02d-e589-4019-bb95-4b929aea67df, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/09/temp_shuffle_7031baa5-94b6-4630-8316-c15f6291710a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_599dd279-389e-4aaa-880e-49031a37cf19, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3b/temp_shuffle_9785302a-4f93-44d4-9ee6-3ce38781f9b5, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3b/temp_shuffle_2ae5e898-4415-40b2-97f9-49bfab33283e, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3f/temp_shuffle_a8673f6b-e894-42fd-9718-d32cc7553f9b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/08/temp_shuffle_1c1011ba-88fd-48c6-a03e-f1d49ce4876b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/28/temp_shuffle_b90be459-714f-4220-ab1f-d794151c7c45, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/26/temp_shuffle_e4b7694d-9e8b-49ad-ad4d-770a73298c22, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3f/temp_shuffle_e2b3db32-c5ac-4acb-8b10-cb1ed89df219, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3f/temp_shuffle_f4d1cd3d-90e8-4432-9861-1374113903aa, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/05/temp_shuffle_98507e6c-4658-44b4-baf4-8cfa979e40f9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3f/temp_shuffle_00a08724-cbbb-4f9a-a19a-d1258b3ea363, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_04647f1f-d4ab-4cc9-874e-557d77de0a26, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/30/temp_shuffle_392afd0b-b7f1-466c-a236-16498b6c8688, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/29/temp_shuffle_2bc43768-d113-41af-b5d2-cb1906b5eba1, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/18/temp_shuffle_1adf8166-3409-4f73-b3ae-91605ad9de09, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3c/temp_shuffle_c130e0a8-1cc1-400e-954c-2101d2d478bc, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/02/temp_shuffle_4f6284be-78f6-4d68-9c9c-a6029b419be2, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/00/temp_shuffle_d0bbfec9-403a-4234-b38a-c271568f86fc, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/14/temp_shuffle_c908b61b-e329-427d-8a34-c8208d1a48bc, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2b/temp_shuffle_06e98853-25f5-4aa2-b9f1-90f3eff20a44, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2e/temp_shuffle_c599bc02-e8f2-43ca-8bff-6a69f803ebd8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/10/temp_shuffle_3a4b800a-729d-426b-b784-26bb6c4f917c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/28/temp_shuffle_dcda0e50-b0ae-476b-9b99-bf8e25ddf009, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_4aa9687e-21ce-4b2d-8d1e-9f23ffe23672, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0c/temp_shuffle_3458866f-b4f4-42c4-a74e-2c3981a12f5b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/06/temp_shuffle_e422e338-9ec2-4dfd-93b4-5c02982eb01a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_d25b4266-602e-449e-a944-3db9f8aefda8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3b/temp_shuffle_a2e194b3-b0dd-47b3-8c82-3cdadedb1eff, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/07/temp_shuffle_28a2a6f2-f64b-4ad5-b142-9ea51cbbe58a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/11/temp_shuffle_dcd7c681-0295-4ccb-959e-0133bb819dd9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0a/temp_shuffle_63da42c0-eed0-43df-a23f-2f90354c89b4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/31/temp_shuffle_9cdfa686-f5a3-439d-9afa-853cb4d083d7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1b/temp_shuffle_47fb4eeb-97c4-4b14-a244-bcf22a26f475, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1f/temp_shuffle_67d1138e-776e-4405-8391-5d6531dc0e6f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/30/temp_shuffle_2b1860a8-9c37-412b-9fcc-c7fa7f82555b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3d/temp_shuffle_6d661d30-712a-48f7-9d47-3e5bf96d78a0, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/05/temp_shuffle_302825a3-d7f3-43e5-b5bf-043b55d42388, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/20/temp_shuffle_e2a8dbfa-c0f4-41c2-b0bb-19b3e2fad222, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1f/temp_shuffle_6a18c75a-998f-4053-ba8b-1197787c44b0, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_c4c484d8-b980-4ee2-83b7-66f47ca0a7da, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3c/temp_shuffle_0b3c5b73-c105-41ce-9cf4-e120a4ebea42, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0d/temp_shuffle_0e8a8342-8256-4aec-8886-e8493b46d460, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_7263ecda-835a-4cf6-8a3b-8bf1f8a45c91, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_0f9ee7a0-8da2-4733-9cd4-af1a6722db3c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/33/temp_shuffle_7a4b38fb-0b3b-4c84-9ab7-cd419e204ecf, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3a/temp_shuffle_eecd91ea-0919-4bb1-acbc-ce4d0b8151e7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3e/temp_shuffle_786b141f-58c4-447d-9a5c-4ae4f1a3e265, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/17/temp_shuffle_4da10575-6990-49b6-aeed-8b05a4ccc2a7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/38/temp_shuffle_c5880750-ab4c-4dd4-ba0c-8f3306b98bd4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/37/temp_shuffle_eea299f1-b93f-43a5-9b38-5cf9b28bb50c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2e/temp_shuffle_1f0a1783-09b1-41bf-bf06-1a7a932bd9bd, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3f/temp_shuffle_dcd8c1af-2ec9-4037-b4c2-c488e90d094d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2c/temp_shuffle_e7841695-83c2-4acb-a19a-43f863a00bd7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0d/temp_shuffle_ef0deeca-7fd7-4a43-ab6d-f636573a3a96, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/07/temp_shuffle_2bc4c3cb-23de-4607-b685-ebc6097f8a98, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/06/temp_shuffle_82deb568-a6f4-47a7-ac63-1d49238d0504, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0b/temp_shuffle_080da3c5-c362-4898-8cf9-5b98719698cb, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/00/temp_shuffle_4538f3fe-d7ed-47bc-add8-e4dca47171c0, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/08/temp_shuffle_2cee6258-a89e-4bca-b354-30a1bd7756e3, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0d/temp_shuffle_12a56d6b-e9b2-46ed-abe3-5b6045169122, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2c/temp_shuffle_ca3d2cf1-7985-4d99-bb6b-862035e17833, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0d/temp_shuffle_3ea36f18-46b9-4ad8-a6bb-e15e7fe0084d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/17/temp_shuffle_3ac4b500-ec87-4d36-86b0-f9c1d58607d7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3d/temp_shuffle_84b5655c-c84e-48b0-adc4-a71119f4d4ea, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/12/temp_shuffle_e7508e55-9e58-4ecf-9560-2eb63c255a6d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0f/temp_shuffle_efe85ac4-9622-4a65-a6aa-e938302dac8a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/03/temp_shuffle_55f243ab-a900-47b9-a2dd-7d6476be0376, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/30/temp_shuffle_6ea89097-5243-4cbe-bf1e-4d6026097a38, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_be43922e-27f5-42b3-81fe-902aac2008d6, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3e/temp_shuffle_f64f6605-ed1e-4608-b8f0-b3ebbcd2554f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/02/temp_shuffle_cae54760-b2d7-48a3-b23a-7e279898e55a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_33c6deb6-63a6-47d1-beaa-ad96eca2d31c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3a/temp_shuffle_e2b6e9d2-ab3a-4172-92c1-7ef275381ff8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/28/temp_shuffle_a2d1f08a-c637-4e66-91c7-74ebc515db93, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2d/temp_shuffle_3a73b33e-b632-4cca-9e76-7dfe9c5874f0, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/38/temp_shuffle_234f85ea-17cf-4165-b2e2-229b3abf095f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3b/temp_shuffle_512798ba-b3cb-4c8b-a950-6d2c7218d67c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/32/temp_shuffle_ee47670b-fc23-4954-b153-1bfe750df842, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/20/temp_shuffle_1511dc2a-6158-4be3-8d9a-c4f6edc44c3f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3f/temp_shuffle_7664a456-3ab3-4750-bd0b-70b48b442043, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0f/temp_shuffle_37644884-936b-4243-9b14-dc116ff8b521, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0e/temp_shuffle_1479b7a1-5648-4566-9c74-7f84b2e5c204, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_338f780c-538b-4c09-aaea-a60b41c80686, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3c/temp_shuffle_26017995-a9ad-4672-9c62-57220595198a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/14/temp_shuffle_0bb50846-956b-45d7-8472-695a10d6fa62, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/20/temp_shuffle_7fe1dc55-bc5b-4ecb-a912-e28db759db51, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_d87e8c8e-afed-42fe-a4aa-475a793d308f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3d/temp_shuffle_8896e951-9a03-4afc-8be2-d9fb931afd20, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2c/temp_shuffle_d4703442-64cb-499c-8af7-5d83832cf476, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/36/temp_shuffle_439826ce-6bc0-4752-8d21-d9316261202c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3f/temp_shuffle_0c4e7b7f-5c8e-4603-a14e-1c39521c8855, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2a/temp_shuffle_3f530a22-d414-4817-86ce-abdd6d338247, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/18/temp_shuffle_6f242813-65db-4aa2-ad17-9879d0b30986, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/32/temp_shuffle_3660690c-f389-425f-975b-1e8ea89a5b7b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/31/temp_shuffle_f44b64dc-19d6-4103-a1eb-af5692696d64, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/12/temp_shuffle_1306dd2a-75a7-4375-95bc-d23fba6a1c30, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0a/temp_shuffle_2da059dc-7f14-4b1f-baea-d9a82466c47c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3f/temp_shuffle_e2b4e303-cb0c-48ab-8b56-8777b9482b6b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/18/temp_shuffle_cda45e06-0192-4539-923c-8fa049989c31, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/34/temp_shuffle_5e528d24-f52f-41a4-82d5-a1e51b231d81, null\n23/04/19 04:12:50 WARN scheduler.TaskSetManager: Lost task 21.0 in stage 13949.0 (TID 142955, sandbox-hdp.hortonworks.com, executor driver): TaskKilled (Stage cancelled)\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3b/temp_shuffle_15465488-9dfd-4276-9740-7e2e771db1b4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/31/temp_shuffle_3cdb4d5f-9421-4d8d-80c8-7f26a0cd5592, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/35/temp_shuffle_077a0ea0-c78b-4754-a03d-87327c40e1e4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/25/temp_shuffle_e289ab04-cde0-40a0-802c-4a166011f4a2, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0e/temp_shuffle_aa25dd28-abbc-4f5d-b8e8-40ee13d56def, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/12/temp_shuffle_ac5afabb-3cc0-492b-9993-9e4fd4604d24, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/20/temp_shuffle_a94f7d5e-8213-4c9d-b966-29b152f58975, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/01/temp_shuffle_158da740-baa7-4c6f-acd4-bbb05debf01c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/11/temp_shuffle_f2cc5538-2f9b-49ec-835d-5505769dd1d9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1c/temp_shuffle_b5c0c855-b789-4f28-aecd-0abe0057cb26, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/11/temp_shuffle_1b21ce40-99c4-47a5-a26f-e3ccf04ec9f4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3a/temp_shuffle_c0ad9174-1a7a-481d-b671-5547ed03fa12, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3c/temp_shuffle_f95b1e19-8c84-448d-a19d-f6986f4ad3e7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2b/temp_shuffle_72793a6a-7a38-443f-9842-f23b0e7f07cd, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3d/temp_shuffle_642efe8b-80fe-4f4c-86e8-e0c425348aa7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3b/temp_shuffle_9bcb9496-a678-446b-a50b-0f26243e592d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/00/temp_shuffle_bff59d1e-30d7-4e43-8762-0a398755c2c6, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/01/temp_shuffle_c0e762fe-3529-49e7-b889-c3439149e3af, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/33/temp_shuffle_e3ee5909-c7e5-48e1-8092-8b6bfad54938, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/01/temp_shuffle_7b995bb1-b33a-49ab-bf0e-02b7be0a61f9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/37/temp_shuffle_29f4afb5-9f11-45ee-91c7-70e909c3821b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/28/temp_shuffle_eff3ce0a-af55-4b79-be07-d09f50f9cabb, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1b/temp_shuffle_44c2f0c1-5b20-496e-94f8-960f77122b58, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_dfae0632-197a-4886-8cbe-d4c6cfc3696c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3a/temp_shuffle_7bf6c027-863f-43d8-afd9-2d947c311a6c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1d/temp_shuffle_bb81052f-bd8c-463c-95d2-50b8ed1a69ea, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3b/temp_shuffle_78f3c9b4-44ce-4a0d-82bf-6ea4aa5582ab, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/36/temp_shuffle_42eaa1f0-d8ed-46c0-a24e-6bff8e3867e1, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/33/temp_shuffle_0928e0b8-bb38-42a0-a2c1-986320577e32, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0e/temp_shuffle_18b52e22-83d5-4aea-8698-84e98958f75d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/10/temp_shuffle_2fbecbe1-605e-4fd6-a851-fc772c937ffe, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/19/temp_shuffle_4b46d592-c0dd-4e1d-9b99-1ca204b1afb5, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/25/temp_shuffle_00ad7328-5f01-40c2-893e-f6db896aee49, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/29/temp_shuffle_f3d7b3af-4a27-41de-80cc-ab3ba34716bf, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1d/temp_shuffle_4a9a05a4-9c1f-4f9d-b3b2-9fdb99b64612, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/03/temp_shuffle_7fc65c5b-4f86-420a-a469-74e08a315e6c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/22/temp_shuffle_18b8e26d-db49-40ce-9f57-d0b391a1ad27, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1c/temp_shuffle_bf952dbd-a5bd-4087-a316-1d422c02955f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/39/temp_shuffle_e504854b-2498-4998-9fff-2c07258dccd0, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2c/temp_shuffle_90554932-4193-416f-bb34-3e779dd13947, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/21/temp_shuffle_cc96fcdb-796c-409d-8965-19a7ea85fb9f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/33/temp_shuffle_e74774c4-9a91-425f-a491-29ef462ba21a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1c/temp_shuffle_d569a126-21fa-43ae-abad-cc649a21dc68, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_f01ddad2-1c9f-4a71-98f1-296f9e784a1e, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_e48f381e-3459-4331-8c0c-2b698ddd27fc, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_e989e346-beb8-496d-9154-0ba741070e2e, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/22/temp_shuffle_9f4721a3-99b9-4817-92ca-7d8a4e960e72, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0d/temp_shuffle_8cdbb9aa-06de-4653-aeeb-4afe476a70b3, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2a/temp_shuffle_23746bac-6556-4203-88fb-b1313a8c4b0d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/23/temp_shuffle_9063c48c-9ffe-4363-bcf4-bc67e114944c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3e/temp_shuffle_a8232a56-dd17-4485-98ef-6d75558b9012, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/12/temp_shuffle_cff27edf-38bb-41f7-bbf4-a35f12c2861c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3a/temp_shuffle_d451fddb-ec4d-4c55-b038-365cd0a3486b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/28/temp_shuffle_d8d99497-3ff1-4f56-a77b-4d1fa0ff08d9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/36/temp_shuffle_68fc8b98-0bc5-4f06-bc73-ab0023bd15b4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3a/temp_shuffle_b5a6cf08-5e60-41e7-85ac-417322e2d80f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/23/temp_shuffle_fb260967-5b28-48de-a053-866710b8eaf9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/39/temp_shuffle_f288c9e2-966b-4b79-8ca2-8ea8a915676c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1c/temp_shuffle_59e3ee20-0fb2-4df1-8d91-bde1fc54b4b8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2b/temp_shuffle_41f15e8b-21f5-4d86-9865-febf40d6916c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/19/temp_shuffle_3d91e671-b54d-4d37-91c3-db988a13243b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/30/temp_shuffle_33eff3ad-3bdc-4341-84c4-6355a0780bb0, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/01/temp_shuffle_01476078-fccf-4a53-88cf-bede5519acfa, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3b/temp_shuffle_4b266adc-5949-42e0-874a-fc6fe1e9a3af, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1c/temp_shuffle_98a6bd10-7de1-42b0-8172-bd6eec3aafc8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0a/temp_shuffle_0f81e3d3-0b8e-4ead-a044-cc677e29d0a2, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/21/temp_shuffle_85d7dde2-a9e2-4841-be96-6afd4c123078, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1d/temp_shuffle_bff49dd3-372e-4692-9568-8de68e7c8fea, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/15/temp_shuffle_fe4b7efb-acb0-4fc2-ae05-aa1f8d93caac, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2e/temp_shuffle_dee2fae6-fcb3-47f6-8594-02adcb253f40, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_183c651f-ad64-431f-8493-28fc05f8dc56, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/30/temp_shuffle_11d91364-ce0f-4037-8ad5-73c10eae7ab1, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_39a9a6ce-2e17-45d9-a77c-dee7fbb52188, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3d/temp_shuffle_5642dd81-4ae7-4dc6-8245-df0e46f0403e, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/30/temp_shuffle_60686a5e-543e-4bb8-90e3-b723762d420e, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_d8ffe101-b998-491b-a959-a30512aea9d8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_cefa4231-bed5-496d-8e9b-dfb0cff837a8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/35/temp_shuffle_8b75ea38-9f01-4c98-84ff-b59fdd2f3853, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/06/temp_shuffle_54530002-f82c-4263-be1f-652e18f7cb78, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/02/temp_shuffle_ef9ceb6f-2da6-4293-9b55-927c417b0f5c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/27/temp_shuffle_1cb00e89-2402-428e-8901-9a6f169845f6, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/39/temp_shuffle_1f55a255-7b89-4be3-aaed-f2adffcf8f65, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/01/temp_shuffle_60846707-873e-4ee1-9fe7-37277e7f45ca, null\nException AttributeError: \"'RankingMetrics' object has no attribute '_sc'\" in 23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/31/temp_shuffle_825b9718-9715-4546-9627-fe9754b7f4b8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/37/temp_shuffle_de193cd4-3a70-4eac-a598-29fc601ef8cc, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/09/temp_shuffle_369341ce-4974-4bf3-946b-a52577c88dcc, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/24/temp_shuffle_5346097b-2635-45ab-b345-e83fd4e80ec2, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/06/temp_shuffle_91a4851b-1afe-4db4-a354-f2ccedfe6fff, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3c/temp_shuffle_ce5606a6-59cb-4758-add8-80a6d9fec6f3, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/06/temp_shuffle_8dda1f74-6e15-4cd0-9c6b-67bbb692ff7e, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/28/temp_shuffle_be664abf-cb43-4b21-bf54-ddba3f6c570f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/21/temp_shuffle_db84ca97-f293-41b7-8995-acba0b17ee3c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/34/temp_shuffle_f87064f1-dee1-482d-9736-47a69728bd9b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/36/temp_shuffle_d16d1c66-63bd-4c4b-8dea-7cd6e776a983, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0f/temp_shuffle_9b848c31-0597-48c3-a4d7-14bd673d1b54, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/19/temp_shuffle_153bd0b7-cd8f-4042-8777-6a5f4ffea29c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_ed912744-7edb-4a16-ac18-4fc7332a3479, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0a/temp_shuffle_807d136d-d144-46cb-bce6-6e313af66fe8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/38/temp_shuffle_83bd45a6-c5c3-40d9-bb03-aa243ea89d4f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/03/temp_shuffle_e51f48c0-f9c7-485a-8cbf-e56d08c8c9d5, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/15/temp_shuffle_888f3f20-b847-48dc-8449-552bba414fa5, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2c/temp_shuffle_04219628-5747-4816-aa86-daafa2cd2874, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2a/temp_shuffle_4006d1c5-5f3b-41f2-8b83-daf194c49cb8, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/02/temp_shuffle_e7ad8a96-8b31-460c-a07c-acbd329bafb1, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/25/temp_shuffle_cc333d08-f900-437e-9921-e8ded49f839c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0c/temp_shuffle_63cae9ad-46c1-4202-bf82-69bdef7b83f1, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_ef94b81f-5c70-4656-88d9-4d1beae35949, null\n<bound method RankingMetrics.__del__ of <pyspark.mllib.evaluation.RankingMetrics object at 0x7f3be09b7f10>> ignored\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/35/temp_shuffle_89b31e2e-dfcb-4e11-9490-77b8d31560cc, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2b/temp_shuffle_fc4774cd-92a4-45d2-9499-016e9a10face, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_9b702dcc-0aa3-4760-8e28-1f03fecdc4db, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2e/temp_shuffle_a04948df-597c-4e27-a28f-9882f3d72c4f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2a/temp_shuffle_8802d078-d5bd-472b-9607-85f8da83daa7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0e/temp_shuffle_53422ef9-033b-436a-8ac5-f951d79afe70, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_22067270-303f-4090-8260-5e7439e4c87b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/11/temp_shuffle_f321e787-6f7f-4224-a316-a2a7ce10a176, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/18/temp_shuffle_c5ef175b-fc3a-4a90-867e-ec68366478b4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_84719866-de6c-4a0b-bd18-8e15abb5b21a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_27285e9d-c59b-4be2-9997-8c568cdfb8fb, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/15/temp_shuffle_72cab83d-a847-4d7b-9b40-08a0d44a7160, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1e/temp_shuffle_5679c5f1-1f9b-44a7-a816-19a1842bd9fb, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/25/temp_shuffle_d48bb041-31a9-41e7-8763-3b979a9fe7c7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/39/temp_shuffle_9efdfc18-225c-4f57-a44b-d1a70da7a290, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/00/temp_shuffle_6a3ca633-c988-41c9-8513-4c254cfb47bc, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/12/temp_shuffle_fdcda1d8-6d65-439b-9408-47207ff97886, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/18/temp_shuffle_decf9aa8-3286-48b6-973f-f6306a005876, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2a/temp_shuffle_2fb295e7-69ed-449c-ac83-b3d3eac0ebdf, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1c/temp_shuffle_a3dc8f7c-6b9b-4a23-8fae-b82736ba55bf, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2a/temp_shuffle_723c0b67-458c-4640-a782-5f6cb2f06d3f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/00/temp_shuffle_6d2f0a49-fdac-4804-9ebb-0337b1d871b9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0a/temp_shuffle_85be5689-d8fa-49f1-8b04-43b535d4c76b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1d/temp_shuffle_0b14cff7-3bd7-492a-83ef-ff27610d6010, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/02/temp_shuffle_5e5144f3-ae18-4063-b9c7-968565752055, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1a/temp_shuffle_5f0658aa-7a2c-4301-af74-90e7d6575000, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/19/temp_shuffle_37ad61dc-9107-4aa3-ab27-85fa43be174a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/30/temp_shuffle_9cf17bff-2ae0-4335-95d6-7de9047a24b7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/14/temp_shuffle_c27cb16a-0609-4f12-8543-aaa26a5eacf6, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_2aad817b-76a7-4062-8e22-03403f983d5c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0e/temp_shuffle_df90c172-4dcb-40b3-bada-b5c72e8dd08c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/20/temp_shuffle_7360e6ea-0fc0-4703-a7d9-117b817c48aa, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/39/temp_shuffle_6f50ca72-3a97-4459-835c-cdf8b45c2d3c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_bf3f2ea4-3770-46a4-ae0d-fd49a8e2c9b3, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/32/temp_shuffle_ab340040-1acf-441a-8b9c-401c6b578c4c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/07/temp_shuffle_6ba5a654-40ad-4b7d-b99b-d4bdf7ccaa03, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/30/temp_shuffle_fc33210d-aa15-46e6-b7bf-06b4770eb0ec, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/09/temp_shuffle_08ae3f03-2219-4c02-bbfe-5f1c09485dfa, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3e/temp_shuffle_104c809c-6731-4efd-a230-ab2253ea509b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/24/temp_shuffle_4afc55d3-4bf0-4ce2-8afd-fa99c35b2766, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/19/temp_shuffle_3dba270d-7a4f-4f37-a5bb-0b44cc1406ca, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/22/temp_shuffle_e81be175-1bb5-4110-b483-07ae9382b117, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1c/temp_shuffle_5237289b-fb2f-41c8-8c87-2023ae9e210e, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3c/temp_shuffle_9d2e29b5-2d0e-4bf2-806c-114069d68fd2, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/25/temp_shuffle_ca31a6ae-5193-45ba-844b-d1b10684d4c4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/27/temp_shuffle_d35bae2c-f954-499f-acc0-77bc30ad0b78, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/04/temp_shuffle_99e4aa90-cd4f-4f06-ba14-b8f189422114, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/13/temp_shuffle_585c8738-a5bf-4811-be30-c06c0a5590ed, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3e/temp_shuffle_5fb2a45c-0bee-4dbb-9539-23924c79f80b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/07/temp_shuffle_42642c5d-1147-49e6-959b-658f523ab7b3, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/15/temp_shuffle_40faf77c-18b5-490d-b7ec-8c80eba14f80, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/01/temp_shuffle_6781cd99-b866-4af1-acf6-421a7817644d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/07/temp_shuffle_46c11c26-84e3-46ee-b871-63d841ea177a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/24/temp_shuffle_56f06543-ad6c-4255-b744-e7c8d1a7e80d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/36/temp_shuffle_508579ec-ee22-4ce7-87b1-416959855493, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2e/temp_shuffle_d7b47173-727c-49e8-85ad-92faf12d0077, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2c/temp_shuffle_7addd09b-7686-4d64-adab-744334c01f3c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/22/temp_shuffle_44f5814f-b778-486c-b4ed-897bcb42e41f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/36/temp_shuffle_649b1e71-2f8a-4ae6-8385-e04e6a235411, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/25/temp_shuffle_b1cf47d6-c3ad-4417-b07d-9c67c85fa4d5, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/14/temp_shuffle_4fde5079-ada3-49d9-8b77-45de5533dd5c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/32/temp_shuffle_ede727e4-dc3b-4499-ae79-80d252351965, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/36/temp_shuffle_159d8874-299d-4c83-8dca-8fd1883c6963, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/30/temp_shuffle_f7057563-14f5-46bf-9ce2-5bd9b7434681, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1f/temp_shuffle_2c5316e4-231b-4392-a121-4001fb35cd60, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/05/temp_shuffle_4e8152ed-5dd7-469e-a609-69f17bc6865a, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/24/temp_shuffle_7d2619b7-a146-455b-8ae8-2d63454e0095, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0a/temp_shuffle_bbfed62f-f17c-47e6-b63a-fb0ecb9ed2e4, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/31/temp_shuffle_8dceb5d8-28e3-432d-bd58-c02ebfed8faa, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0f/temp_shuffle_d37c22a8-8728-41df-8cb1-210790c64ae6, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/11/temp_shuffle_0d8c0efe-c850-462c-b28b-bce81a4620dd, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/31/temp_shuffle_c9de857d-4486-485d-a533-5a89e9e1da1c, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2f/temp_shuffle_5d3a9e91-be26-44b2-a8e1-bb0303a82130, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/39/temp_shuffle_25f549c1-e5f8-4be8-96af-b506f87010ad, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3d/temp_shuffle_caadc159-250e-4720-ac6e-12d094dcbfa7, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/33/temp_shuffle_dae91a47-5976-41c5-906d-1eadac27d854, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/22/temp_shuffle_7faaa38f-6619-4b5c-bb07-7a8ee588f693, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2f/temp_shuffle_dd4f85ef-6d29-4939-ae8a-e3f3f4d0c2cd, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/29/temp_shuffle_1d5d65bb-290a-472e-adde-52f7f09ca518, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/29/temp_shuffle_b3bdb5c5-801b-474d-bfb7-79687bfc89e5, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/17/temp_shuffle_e5c5c68e-76e0-4100-a067-3e70eeeb5e94, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/14/temp_shuffle_7074ca1a-5181-4890-98c8-259a794772bd, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/1d/temp_shuffle_9884830a-3ddd-4fc6-8ad0-7b81d67009c1, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/19/temp_shuffle_f7eceaa1-937c-4f81-ad11-24e716834a8b, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2b/temp_shuffle_043ae128-9f15-47c5-b448-e1ea576a21ec, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/36/temp_shuffle_bb998aef-53c7-4800-91a5-e1729f1e0a40, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/00/temp_shuffle_eeda216d-4b38-42cf-8dc8-c2ff58597c0f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/21/temp_shuffle_1115a78f-0e29-4157-b52a-8169e99c627f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3f/temp_shuffle_7fc9c2d2-e511-4b25-9c1a-c36748c6ba22, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/0b/temp_shuffle_c7ddc150-6911-4ffa-82b8-d9126cdf6fa9, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/2b/temp_shuffle_583c7e95-2962-4691-b783-377fea5e9de1, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/39/temp_shuffle_03e4b30c-be43-470e-8051-7e5798b5de61, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/30/temp_shuffle_c2a56086-bbfe-4848-bc4f-87d40255daee, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/34/temp_shuffle_adf6b29d-2c0a-4d13-8f99-c3726b5b5dcc, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3b/temp_shuffle_53272c85-9b66-4df4-92d5-bf8fe73b5c8e, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3e/temp_shuffle_558608a1-43a4-43a8-88ae-79d139bed43f, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/14/temp_shuffle_7b2cb7af-e5a9-447e-9413-b4f23d407e36, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/25/temp_shuffle_28c0b09a-18e5-477b-9794-2c79a8e8f600, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3a/temp_shuffle_89f4a6f0-e152-4625-885b-3c6e431afbce, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/09/temp_shuffle_fdf64540-510a-4b86-a6ae-9e75059b721e, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/18/temp_shuffle_05a641ce-912c-4000-b304-6a27948a767d, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/06/temp_shuffle_dcda02cb-fbc8-49b2-ae3e-5c30011bad53, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/11/temp_shuffle_921d713e-a38f-4fab-91cc-42c1114a1d34, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/11/temp_shuffle_6f71fed8-f239-4ffd-b25c-53577555aefe, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/08/temp_shuffle_c584e4a0-e87a-45aa-b87f-9ee211c57dbf, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/10/temp_shuffle_c0cbeeb1-577c-4dc1-afd8-0565c6969750, null\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/base.py\", line 170, in transform\n    return self._transform(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/wrapper.py\", line 338, in _transform\n    return DataFrame(self._java_obj.transform(dataset._jdf), dataset.sql_ctx)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/usr/lib/python2.7/site-packages/pyspark/sql/utils.py\", line 134, in deco\n23/04/19 04:12:50 WARN scheduler.TaskSetManager: Lost task 15.0 in stage 13949.0 (TID 142949, sandbox-hdp.hortonworks.com, executor driver): TaskKilled (Stage cancelled)\n    raise_from(converted)\n  File \"/usr/lib/python2.7/site-packages/pyspark/sql/utils.py\", line 33, in raise_from\n    raise e\npyspark.sql.utils.IllegalArgumentException23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/35/temp_shuffle_11d46a62-1533-4e73-ae15-b9aab3760f6e, null\n23/04/19 04:12:50 ERROR storage.DiskBlockObjectWriter: Exception occurred while reverting partial writes to file /tmp/blockmgr-5117d042-c35c-4ec4-9b94-b713c82edb5b/3a/temp_shuffle_1aae6b88-a793-4dd8-bc7e-c1830c38883b, null"},{"type":"HTML","data":"<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 102400 bytes. Learn more about <strong>ZEPPELIN_INTERPRETER_OUTPUT_LIMIT</strong></div>"}]},"apps":[],"jobName":"paragraph_1695400866736_2106570307","id":"20230418-205831_838184241","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41574"},{"text":"from pyspark.ml.feature import BucketedRandomProjectionLSH\n\n### Automatically helps us handle duplicate ratings\nbrp = BucketedRandomProjectionLSH(inputCol=\"scaled_features\", outputCol=\"hashes\", bucketLength=2.0,\n                                  numHashTables=3)\n\nbrp_model = brp.fit(train_transformed)","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400866931_1737596112","id":"20230418-210826_1179058226","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41575"},{"text":"test_transformed.first()","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866942_1733363874","id":"20230418-212601_1553005708","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41576"},{"text":"test_transformed.first()['scaled_features']","dateUpdated":"2023-09-22T16:41:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866966_1822625619","id":"20230418-212322_1475122166","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41577"},{"text":"brp_model.approxNearestNeighbors(train_transformed, test_transformed.first()['scaled_features'], 5).collect()","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400866994_1811852650","id":"20230418-210127_740863282","dateCreated":"2023-09-22T16:41:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41578"},{"text":"### Gradient Descent","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400867040_1780303240","id":"20230418-215037_1125503279","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41579"},{"text":"from pyspark.ml.feature import IndexToString\n\n\nindexer_delay = StringIndexer(inputCol='Trip_id', outputCol='TripIndex')\n\ndelay_model = indexer_delay.fit(train_transformed)\ndelay_df_transformed = delay_model.transform(train_transformed)\ninverter_delay = IndexToString(inputCol=\"TripIndex\", outputCol=\"delay\", labels=delay_model.labels)\n\n\n","dateUpdated":"2023-09-22T18:25:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400867049_1776840500","id":"20230418-221700_1169240042","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41580"},{"text":"def makePairs( userRatings ):\n    ratings = userRatings[1]\n    (beer1, rating1) = ratings[0]\n    (beer2, rating2) = ratings[1]\n    return ((beer1, beer2), (rating1, rating2))\n\n\nbeerPairs = uniqueJoinedRatings.map(makePairs)","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400867084_1861870007","id":"20230504-113211_1991854606","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41581"},{"text":"def computeCosineSimilarity(XY):\n    num = 0\n    sum_xx = sum_yy = sum_xy = 0\n    for X, Y in XY:\n        sum_xx += X * X\n        sum_yy += Y * Y\n        sum_xy += X * Y\n        num += 1\n    numerator = sum_xy\n    denominator = sqrt(sum_xx) * sqrt(sum_yy)\n    score = 0\n    if (denominator):\n        score = (numerator / (float(denominator)))\n    return (score, num)\n    \n\nPairSimilarities = beerPairRatings.mapValues(computeCosineSimilarity).cache()","dateUpdated":"2023-09-22T18:28:22+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400867107_1854559778","id":"20230504-114001_2147049064","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41582"},{"text":"scoreThreshold = 0.95\ncoOccurenceThreshold = 100\n\ntripID = 3788\n\n# Filter for Books with this sim that are \"good\" as defined by\n# our quality thresholds above\nfilteredResults = PairSimilarities.filter(lambda pairSim: \\\n    (pairSim[0][0] == tripID or pairSim[0][1] == btripID) \\\n    and pairSim[1][0] > scoreThreshold and pairSim[1][1] > coOccurenceThreshold)\n\n# Sort by quality score.\nresults = filteredResults.map(lambda pairSim: (pairSim[1], pairSim[0])).sortByKey(ascending = False).take(10)\n\nprint(results)","dateUpdated":"2023-09-22T18:29:12+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400867175_1828396852","id":"20230506-101009_202399405","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41583"},{"text":"train_df = df_transformed.dropDuplicates(['delayIndex'])","dateUpdated":"2023-09-22T18:30:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400867203_1916119602","id":"20230418-233001_867682843","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41584"},{"text":"reviews_rdd = train_df.rdd.map(lambda x: (x['reviewerIndex'], x['productIndex'], x['total']))\njoinedRatings = ratings.join(ratings)","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400867218_1922660333","id":"20230419-041352_165670127","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41585"},{"text":"from pyspark.mllib.linalg.distributed import CoordinateMatrix, MatrixEntry\nmatrix = CoordinateMatrix(reviews_rdd.map(lambda coords:MatrixEntry(*coords))).toRowMatrix()","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400867233_1903038139","id":"20230419-041656_1528026924","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41586"},{"text":"### SVD fails when we are predicting for unseen values in the matrix\nsvd = matrix.computeSVD(5, computeU=True)\n","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400867289_1893804165","id":"20230419-041851_1886891015","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41587"},{"text":"from pyspark.mllib.linalg.distributed import RowMatrix\nrows = sc.parallelize(V.T)\nmat = RowMatrix(rows)\ncolSim = mat.columnSimilarities()","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400867409_1552147142","id":"20230504-110640_2044184002","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41588"},{"text":"import numpy as np\nV = svd.V.toArray()\n\n\ndef cosine_similarity(v,u):\n    return (np.matmul(v,u))/ (np.linalg.norm(v) * np.linalg.norm(u))\n\nsimilarity = np.empty(5)\nsimilarity.fill(-np.inf)\n\nhighest_similarity = -np.inf\nhighest_sim_col = -1\n\nfor col in range(1,V.shape[1]):\n    similarity = cosine_similarity(V[:,0], V[:,col])\n    if similarity > highest_similarity:\n        highest_similarity = similarity\n        highest_sim_col = col","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400867461_1618323953","id":"20230419-044947_1652814799","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41589"},{"text":"import numpy as np\nfrom pyspark.ml.linalg import Vectors, DenseVector\nfrom pyspark.ml import Estimator, Transformer\nfrom pyspark.ml.util import DefaultParamsReadable, DefaultParamsWritable\nfrom pyspark.ml.param.shared import HasInputCol, HasOutputCol, Param, Params, TypeConverters\nfrom decimal import Decimal\n\nclass GDCollaborativeUsingNumpy(Estimator,Transformer, DefaultParamsReadable, DefaultParamsWritable):\n    maxIter = Param(Params._dummy(), \"maxIter\", \"Max iteration\", typeConverter=TypeConverters.toFloat)\n    rank = Param(Params._dummy(), \"rank\", \"Rank\", typeConverter=TypeConverters.toInt)\n    regParam = Param(Params._dummy(), \"regParam\", \"regParam\", typeConverter=TypeConverters.toFloat)\n    alpha = Param(Params._dummy(), \"alpha\", \"alpha\", typeConverter=TypeConverters.toFloat)\n  \n    def __init__(self,lamda, alpha, max_iter, K, user_count, item_count):\n        super(GDCollaborativeUsingNumpy, self).__init__()    \n        self._setDefault(maxIter=max_iter, rank = K, regParam = lamda, alpha =alpha)    \n        self.user_count = user_count\n        self.item_count = item_count\n        \n    def _fit(self, df):    \n        maxIter = self.getOrDefault(self.maxIter)\n        rank = self.getOrDefault(self.rank)\n        lamda = self.getOrDefault(self.regParam)\n        alpha = self.getOrDefault(self.alpha)\n        self.user_latents = np.random.normal(0,1,size=(self.user_count, rank))\n        self.item_latents = np.random.normal(0,1,size=(self.item_count, rank))   \n        while maxIter > 0:\n          for review in df.collect():\n            item_id = int(review.productIndex)\n            user_id = int(review.reviewerIndex)\n            user = self.user_latents[user_id]\n            item = self.item_latents[item_id]\n            rating = float(review.total)\n            pred = np.dot(user.T, item)\n            e = rating - pred\n            self.user_latents[user_id] += alpha * (e * item - lamda * user)\n            self.item_latents[item_id] += alpha * ( e * user - lamda * item)  \n            self.user_latents = (self.user_latents - np.min(self.user_latents))/(np.max(self.user_latents) - np.min(self.user_latents))\n            self.item_latents = (self.item_latents - np.min(self.item_latents))/(np.max(self.item_latents) - np.min(self.item_latents))\n          maxIter -=1\n        return self \n    \n    def predict(self, df):    \n        temp = self.item_latents.tolist()\n        temp_2 = self.user_latents.tolist()\n        func = lambda x,y: float(Vectors.dense(temp[int(x)]).dot(Vectors.dense(temp_2[int(y)])))\n        return df.withColumn('prediction', F.udf(func)('productIndex','reviewerIndex'))\\\n        .withColumn('prediction',col('prediction').cast(DoubleType())) \n    \n    def _transform(self, df):\n        temp = self.predict(df)\n        predicted_products = temp\\\n          .withColumn('productIndex',col('productIndex'))\\\n          .groupby('reviewerid')\\\n          .agg(F.collect_list(F.struct('prediction','productIndex')).alias('collected_list'))\\\n          .withColumn('collected_list', F.expr('sort_array(transform(collected_list, c-> struct(c.prediction, c.productIndex)), False)'))\\\n          .withColumn('predicted_products',col('collected_list')['productIndex']).drop('collected_list')\n        \n        rated_products = temp\\\n        .withColumn('productIndex',col('productIndex'))\\\n        .groupby('reviewerid')\\\n        .agg(F.collect_list(F.struct('rating','productIndex')).alias('collected_list'))\\\n        .withColumn('collected_list', F.expr('sort_array(transform(collected_list, c-> struct(c.total, c.productIndex)), False)'))\\\n        .withColumn('rated_products',col('collected_list')['productIndex']).drop('collected_list')\n        \n        return predicted_products.join(rated_products, (rated_products.reviewerId == predicted_products.reviewerId), how = \"inner\").drop('reviewerId')","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400867476_1624864684","id":"20230418-215046_1562179024","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41590"},{"text":"gdc = GDCollaborativeUsingNumpy(0.1, 0.1, 1,20,person.count(), review[['beerid']].distinct().count())","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400867483_1623710437","id":"20230418-215919_297075920","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41591"},{"text":"gdc.fit(train_df)","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400867490_1608705230","id":"20230418-220332_883217101","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41592"},{"text":"from pyspark import keyword_only\nfrom pyspark.ml import Transformer\nfrom pyspark.ml.param.shared import HasInputCol, HasOutputCol, Param, Params, TypeConverters\nfrom pyspark.ml.util import DefaultParamsReadable, DefaultParamsWritable\nfrom pyspark.sql import DataFrame\nimport pyspark.sql.functions as F\n\nclass MonthSineTransformer(Transformer):  \n    def __init__(self, input_col= \"month\", output_col = \"month_sin\"):    \n        super(MonthSineTransformer, self).__init__()\n        self.input_col = input_col\n        self.output_col = output_col\n  \n    def _transform(self, df):\n        return df.withColumn(self.output_col, F.sin((col(self.input_col)*pi)/6))","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400867615_1671419301","id":"20230418-182625_985474692","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41593"},{"text":"class MonthCosTransformer(Transformer):  \n  def __init__(self, input_col = \"month\", output_col = \"month_cos\"):    \n    super(MonthCosTransformer, self).__init__()\n    self.input_col = input_col\n    self.output_col = output_col\n  \n  def _transform(self, df):\n    return df.withColumn(self.output_col, F.cos((col(self.input_col)*pi)/6))","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400867619_1657568341","id":"20230418-182614_525823881","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41594"},{"text":"from pyspark.ml.feature import Word2Vec, IDF,Tokenizer,StopWordsRemover, StandardScaler\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.feature import OneHotEncoder, StringIndexer, VectorAssembler\n\ntext_features = ['profilename','brewery_name','name','style']\ntokenizers = [\n    Tokenizer(inputCol = feature, outputCol=feature + 'token')\n    for feature in text_features\n]\nswremovals = [\n    StopWordsRemover(inputCol=feature + 'token', outputCol=feature + 'sw')\n    for feature in text_features\n]\ntext_encoders = [\n    Word2Vec(vectorSize=20, minCount=0, inputCol = feature + 'sw', outputCol=feature + 'enc')\n    for feature in text_features\n]\n\nmonth_sin_transformer = MonthSineTransformer()\nmonth_cos_transformer = MonthCosTransformer()\n\ndate_assembler = VectorAssembler(\n    inputCols = ['month_sin', 'month_cos', 'year'],\n    outputCol='processed_date'\n    )\n\nfinal_assembler = VectorAssembler(\n    inputCols = [feature + 'enc' for feature in text_features]+['processed_date','aroma','appearance','palate','taste','total','abv'],\n    outputCol = 'processed_features'\n)\nscaler = StandardScaler(inputCol = \"processed_features\", outputCol = \"scaled_features\")\n\npipeline = Pipeline(stages=tokenizers+swremovals+text_encoders+[\n    month_sin_transformer,\n    month_cos_transformer,\n    date_assembler,\n    final_assembler,\n    scaler])","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/text","results":{},"enabled":true,"editorSetting":{"language":"text","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400867626_1654875098","id":"20230418-175442_41607545","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41595"},{"text":"SELECT *\nt1 = FROM Airport\nINNER JOIN Trip\nON  Trip.airportId = Airport.IATA_code\nt2 = SELECT *\nFROM Carrier\nINNER JOIN t2\nON  t2.Carrier_id = Carrier.carrier_code\nt3 = SELECT *\nFROM Plane\nINNER JOIN t3\nON  t3.plane_id = Plane.tail_number\nagg_dataset = t3\ntrain_df, test_df = agg_dataset.randomSplit([0.8, 0.2])","dateUpdated":"2023-09-22T18:35:39+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1695400867631_1652951354","id":"20230418-180039_1452762387","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41596"},{"text":"model = pipeline.fit(agg_dataset)","dateUpdated":"2023-09-22T16:41:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1695400867634_1664109072","id":"20230418-182110_2075894406","dateCreated":"2023-09-22T16:41:07+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:41597"}],"name":"Stage3","id":"2JBQSREAU","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}